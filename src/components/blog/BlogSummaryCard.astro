---
import type { CollectionEntry } from 'astro:content';
import { Image } from 'astro:assets';
import BrutalCard from '@components/layout/Brutalcard.astro';

interface Props {
  post: CollectionEntry<'blog'>;
  tone?: 'red' | 'orange' | 'yellow' | 'blue';
}

const { post, tone = 'yellow' } = Astro.props;
const publishedOn = new Intl.DateTimeFormat('en-US', {
  month: 'short',
  day: 'numeric',
  year: 'numeric',
}).format(post.data.pubDate);
---
<BrutalCard
  tone={tone}
  color='#ffffff'
  class='blog-summary is-subtle flex h-full flex-col gap-6 border-2'
  style='border-color: var(--ink); color: var(--text-primary);'
>
  <div
    class='overflow-hidden rounded-xl border-[3px] bg-white shadow-[4px_4px_0_0_rgba(17,24,39,0.35)]'
    style='border-color: var(--ink);'
  >
    <Image
      src={post.data.imgUrl}
      alt={post.data.title}
      width={720}
      height={540}
      class='h-48 w-full object-cover'
    />
  </div>

  <div class='flex flex-col gap-4'>
    <span
      class='inline-flex w-fit items-center gap-2 rounded-full border-2 bg-white px-3 py-1 text-xs font-semibold uppercase tracking-[0.18em] shadow-[3px_3px_0_0_rgba(17,24,39,0.55)]'
      style='border-color: var(--ink); color: var(--text-primary);'
    >
      <span class='block h-2 w-2 rounded-full' style='background: var(--ink);'></span>
      {publishedOn}
    </span>

    <div class='space-y-3'>
      <h3 class='dm-serif text-2xl font-black leading-tight md:text-[1.75rem]'>
        {post.data.title}
      </h3>
      <span
        class='block h-[6px] w-16 skew-x-[-25deg]'
        style='background: var(--ink); box-shadow: 3px 3px 0 rgba(17,24,39,0.4);'
      ></span>
    </div>
  </div>

  <p class='poppins text-sm leading-relaxed opacity-90 md:text-base'>
    {post.data.description}
  </p>

  <div class='mt-auto flex flex-col gap-4'>
    {post.data.draft && (
      <span
        class='inline-flex w-fit items-center gap-2 rounded-full border-2 bg-[#fef08a] px-3 py-1 text-xs font-bold uppercase tracking-wide shadow-[3px_3px_0_0_rgba(17,24,39,0.55)]'
        style='border-color: var(--ink); color: var(--ink);'
      >
        Draft in progress
      </span>
    )}

    <a class='btn self-start' href={`/blog/${post.id}/`}>
      Read post â†’
    </a>
  </div>
</BrutalCard>
